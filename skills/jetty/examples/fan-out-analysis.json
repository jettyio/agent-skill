{
  "name": "fan-out-analysis",
  "description": "Splits text into chunks, processes each in parallel, then aggregates results",
  "workflow": {
    "init_params": {
      "text": "Your long text to analyze...",
      "child_workflow": "my-collection/analyze-chunk"
    },
    "step_configs": {
      "split_text": {
        "activity": "text_split",
        "text_path": "init_params.text",
        "chunk_size": 1000,
        "overlap": 100
      },
      "parallel_analyze": {
        "activity": "list_emit_await",
        "items_path": "split_text.outputs.chunks",
        "child_workflow_name_path": "init_params.child_workflow",
        "item_param_name": "chunk_text",
        "max_concurrency": 5,
        "continue_on_error": true
      },
      "gather_results": {
        "activity": "extract_from_trajectories",
        "trajectory_ids_path": "parallel_analyze.outputs.trajectory_ids",
        "extract_paths": [
          "analysis.outputs.summary",
          "analysis.outputs.entities"
        ],
        "flatten_results": false
      },
      "final_summary": {
        "activity": "litellm_chat",
        "model": "gpt-4o",
        "system_prompt": "Synthesize the following analysis results into a coherent summary.",
        "user_prompt_path": "gather_results.outputs.extracted_data",
        "response_format": {
          "type": "json_schema",
          "json_schema": {
            "name": "analysis_summary",
            "schema": {
              "type": "object",
              "properties": {
                "summary": { "type": "string" },
                "key_findings": { "type": "array", "items": { "type": "string" } }
              },
              "required": ["summary", "key_findings"]
            }
          }
        }
      }
    },
    "steps": ["split_text", "parallel_analyze", "gather_results", "final_summary"]
  }
}
